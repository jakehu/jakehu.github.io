<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 7.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico">
  <link rel="mask-icon" href="/favicon.ico" color="#222">
  <meta name="google-site-verification" content="ffqpJ1df4Bqm6BrizA-BtLYulKFoRpe69Qhh3oFgr9k">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.loli.net/css?family=Lato:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"www.jakehu.me","root":"/","images":"/images","scheme":"Gemini","darkmode":true,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"default"},"fold":{"enable":true,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":true,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}}</script><script src="/js/config.js"></script>

    <meta name="description" content="提笔为青春，人生正当时">
<meta property="og:type" content="website">
<meta property="og:title" content="晨曦&#39;s Blog">
<meta property="og:url" content="http://www.jakehu.me/page/11/index.html">
<meta property="og:site_name" content="晨曦&#39;s Blog">
<meta property="og:description" content="提笔为青春，人生正当时">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="jakehu">
<meta property="article:tag" content="jakehu">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://www.jakehu.me/page/11/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"zh-CN","comments":"","permalink":"","path":"page/11/index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>晨曦's Blog</title>
  
















<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?49dba96a37e5decb5f648c76a40bf8be";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>

  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">晨曦's Blog</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">This is a window to the soul</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="搜索" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="jakehu"
      src="https://img.jakehu.me/avatar.png">
  <p class="site-author-name" itemprop="name">jakehu</p>
  <div class="site-description" itemprop="description">提笔为青春，人生正当时</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">143</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">16</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">147</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/jakehu" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;jakehu" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:jakehu1991@gmail.com" title="E-Mail → mailto:jakehu1991@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/jakeh" title="Weibo → https:&#x2F;&#x2F;weibo.com&#x2F;jakeh" rel="noopener me" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/jakeh_91" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;jakeh_91" rel="noopener me" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/small/by_nc_sa.svg" alt="Creative Commons"></a>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="返回顶部">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          链接
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <a href="https://www.upyun.com/?utm_source=lianmeng&utm_medium=referral" title="https:&#x2F;&#x2F;www.upyun.com&#x2F;?utm_source&#x3D;lianmeng&amp;utm_medium&#x3D;referral" rel="noopener" target="_blank">又拍云(提供CDN及云存储服务)</a>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.jakehu.me/2019/hexo-baidu-sitemap/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://img.jakehu.me/avatar.png">
      <meta itemprop="name" content="jakehu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="晨曦's Blog">
      <meta itemprop="description" content="提笔为青春，人生正当时">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 晨曦's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/hexo-baidu-sitemap/" class="post-title-link" itemprop="url">Hexo 部署在 Github Pages 怎么提交 Sitemap 给百度？来我教你</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-03-22 10:07:45" itemprop="dateCreated datePublished" datetime="2019-03-22T10:07:45+08:00">2019-03-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-08-01 17:23:09" itemprop="dateModified" datetime="2024-08-01T17:23:09+08:00">2024-08-01</time>
    </span>

  
    <span id="/2019/hexo-baidu-sitemap/" class="post-meta-item leancloud_visitors" data-flag-title="Hexo 部署在 Github Pages 怎么提交 Sitemap 给百度？来我教你" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>470</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>2 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>虽然<code>度娘</code>是一个<code>垮掉</code>的搜索引擎，但是谁叫它在<code>强国</code>是垄断的存在呢。谈谈 <code>Hexo</code> 部署在 <code>Github Pages</code> 怎么提交 <code>Sitemap</code> 给百度。</p>
<h3 id="Sitemap"><a href="#Sitemap" class="headerlink" title="Sitemap"></a>Sitemap</h3><p>因为 <code>Github Pages</code> 禁止百度爬虫所以这里我们不做过多的说明，无疑这种方式是行不通的</p>
<h3 id="自动推送"><a href="#自动推送" class="headerlink" title="自动推送"></a>自动推送</h3><p>目前在用的一种推送方式</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">自动推送是百度搜索资源平台为提高站点新增网页发现速度推出的工具，安装自动推送JS代码的网页，在页面被访问时，页面URL将立即被推送给百度</span><br></pre></td></tr></tbody></table></figure>
<p>安装方式也很简单，只需要在页面中加入以下 <code>JS</code> 即可</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">(function(){</span><br><span class="line">    var bp = document.createElement('script');</span><br><span class="line">    var curProtocol = window.location.protocol.split(':')[0];</span><br><span class="line">    if (curProtocol === 'https') {</span><br><span class="line">        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';</span><br><span class="line">    }</span><br><span class="line">    else {</span><br><span class="line">        bp.src = 'http://push.zhanzhang.baidu.com/push.js';</span><br><span class="line">    }</span><br><span class="line">    var s = document.getElementsByTagName("script")[0];</span><br><span class="line">    s.parentNode.insertBefore(bp, s);</span><br><span class="line">})();</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></tbody></table></figure>
<h3 id="主动推送-实时"><a href="#主动推送-实时" class="headerlink" title="主动推送(实时)"></a>主动推送 (实时)</h3><p>我们重点来说说<code>主动推送</code></p>
<p>首先我们这里需要安装一下生成 <code>sitemap</code> 的包</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i hexo-generator-baidu-sitemap -s</span><br></pre></td></tr></tbody></table></figure>

<p>新建文件 <code>push_sitemap_to_baidu.php</code>，这里我们通过 <code>PHP</code> 来实现</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">// 解析xml</span><br><span class="line">$file = "./public/baidusitemap.xml";</span><br><span class="line">$xml = simplexml_load_file($file);</span><br><span class="line">$urls = array();</span><br><span class="line">foreach ($xml as $key =&gt; $value) {</span><br><span class="line">    $url = array();</span><br><span class="line">    $url = (array) $value-&gt;loc;</span><br><span class="line">    $urls[] = current($url);</span><br><span class="line">}</span><br><span class="line">// 调用百度API</span><br><span class="line">$api = 'http://data.zz.baidu.com/urls?site=https://www.jakehu.me&amp;token=***';</span><br><span class="line">$ch = curl_init();</span><br><span class="line">$options = array(</span><br><span class="line">    CURLOPT_URL =&gt; $api,</span><br><span class="line">    CURLOPT_POST =&gt; true,</span><br><span class="line">    CURLOPT_RETURNTRANSFER =&gt; true,</span><br><span class="line">    CURLOPT_POSTFIELDS =&gt; implode("\n", $urls),</span><br><span class="line">    CURLOPT_HTTPHEADER =&gt; array('Content-Type: text/plain'),</span><br><span class="line">);</span><br><span class="line">curl_setopt_array($ch, $options);</span><br><span class="line">$result = curl_exec($ch);</span><br><span class="line">// 返回结果记录</span><br><span class="line">$time = date("Y-m-d H:i:s");</span><br><span class="line">$content = $time . " --- " . $result . PHP_EOL;</span><br><span class="line">$file = "push_sitemap.log";</span><br><span class="line">$fp = fopen($file, "a+") or die("fail to open the file");</span><br><span class="line">fwrite($fp, $content);</span><br><span class="line">fclose($fp);</span><br></pre></td></tr></tbody></table></figure>
<p>最后会在根目录下生成 <code>push_sitemap.log</code> 日志文件</p>
<p>然后改造 <code>package.json</code> 如下</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">"scripts": {</span><br><span class="line">  "push": "hexo cl &amp;&amp; hexo g &amp;&amp; gulp &amp;&amp; hexo d &amp;&amp; php -f push_sitemap_to_baidu.php"</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>这条命令包含了<code>清理</code>、<code>生成</code>、<code>压缩</code>、<code>部署</code>、<code>推送Sitemap</code>，关于 <code>gulp</code> 压缩部分可看这里<a href="../../2018/hexo-gulp/">【点击查看】</a></p>
<p>最后我们可以直接运行命令进行部署和推送 <code>npm run push</code>，或者将 <code>push</code> 改为 <code>start</code> 直接运行 <code>npm start</code> 即可</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.jakehu.me/2019/centos-chrome-headles/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://img.jakehu.me/avatar.png">
      <meta itemprop="name" content="jakehu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="晨曦's Blog">
      <meta itemprop="description" content="提笔为青春，人生正当时">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 晨曦's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/centos-chrome-headles/" class="post-title-link" itemprop="url">Centos7 之安装 Headless Chrome</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-03-19 17:16:00" itemprop="dateCreated datePublished" datetime="2019-03-19T17:16:00+08:00">2019-03-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-08-01 17:23:09" itemprop="dateModified" datetime="2024-08-01T17:23:09+08:00">2024-08-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%8A%80%E6%9C%AF%E6%B8%A3/" itemprop="url" rel="index"><span itemprop="name">技术渣</span></a>
        </span>
    </span>

  
    <span id="/2019/centos-chrome-headles/" class="post-meta-item leancloud_visitors" data-flag-title="Centos7 之安装 Headless Chrome" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>296</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="Headless-Chrome"><a href="#Headless-Chrome" class="headerlink" title="Headless Chrome"></a>Headless Chrome</h3><p>什么是 <code>Headless Chrome</code>？</p>
<p>在 <code>Chrome59</code> 中开始搭载 <code>Headless Chrome</code>。这是一种在无需显示 <code>headless</code> 的环境下运行 <code>Chrome</code> 浏览器的方式。从本质上来说，就是不用 <code>Chrome</code> 浏览器来运行 <code>Chrome</code> 的功能！它将 <code>Chromium</code> 和 <code>Blink</code> 渲染引擎提供的所有现代 <code>Web</code> 平台的功能都带入了命令行。</p>
<h3 id="intoli"><a href="#intoli" class="headerlink" title="intoli"></a>intoli</h3><p>开始安装之前我们来了解一下这家公司</p>
<p><code>我们(intoli)是一家在数据采集，处理和分析方面具有深厚专业知识的咨询机构。</code></p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p><code>intoli</code> 在其博客上介绍了几种安装 <code>Headless Chrome</code> 的方式，我们采用如下方式安装：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https://intoli.com/install-google-chrome.sh | bash</span><br></pre></td></tr></tbody></table></figure>
<p>安装完成提示：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Successfully installed Google Chrome!</span><br></pre></td></tr></tbody></table></figure>
<p><a target="_blank" rel="noopener" href="https://intoli.com/blog/installing-google-chrome-on-centos/">intoli 安装文档</a></p>
<h3 id="运行chrome"><a href="#运行chrome" class="headerlink" title="运行chrome"></a>运行 chrome</h3><p>我们可以通过如下命令来启动 <code>Chrome</code>，同时将博客截图保存</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">google-chrome-stable --no-sandbox --headless --disable-gpu --screenshot https://www.jakehu.me</span><br></pre></td></tr></tbody></table></figure>

<h3 id="Chromedriver"><a href="#Chromedriver" class="headerlink" title="Chromedriver"></a>Chromedriver</h3><p><code>chromedriver</code> 可以前往<a target="_blank" rel="noopener" href="https://npm.taobao.org/mirrors/chromedriver">淘宝镜像</a>下载，同时通过下面命令进行验证：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">./chromedriver</span><br><span class="line">Starting ChromeDriver 73.0.3683.68 (47787ec04b6e38e22703e856e101e840b65afe72) on port 9515</span><br><span class="line">Only local connections are allowed.</span><br><span class="line">Please protect ports used by ChromeDriver and related test frameworks to prevent access by malicious code.</span><br></pre></td></tr></tbody></table></figure>
<p>如果有如上输出则表示驱动正常运行</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.jakehu.me/2019/pyspider/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://img.jakehu.me/avatar.png">
      <meta itemprop="name" content="jakehu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="晨曦's Blog">
      <meta itemprop="description" content="提笔为青春，人生正当时">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 晨曦's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/pyspider/" class="post-title-link" itemprop="url">关于 pyspider 这个问题你遇到了吗？</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-03-19 15:23:00" itemprop="dateCreated datePublished" datetime="2019-03-19T15:23:00+08:00">2019-03-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-08-01 17:23:09" itemprop="dateModified" datetime="2024-08-01T17:23:09+08:00">2024-08-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%8A%80%E6%9C%AF%E6%B8%A3/" itemprop="url" rel="index"><span itemprop="name">技术渣</span></a>
        </span>
    </span>

  
    <span id="/2019/pyspider/" class="post-meta-item leancloud_visitors" data-flag-title="关于 pyspider 这个问题你遇到了吗？" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>142</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>最近心血来潮想鼓捣鼓捣爬虫于是玩起了 <code>pyspider</code>，不过在启动的时候却遇到了一些小问题。</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ValueError: Invalid configuration:</span><br><span class="line">  - Deprecated option 'domaincontroller': use 'http_authenticator.domain_controller' instead.</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p>最后定位在了 <code>wsgidav3.x</code> 问题，<code>pyspider</code> 会默认安装 <code>wsgidav3.x</code>，解决办法为先把 <code>3.x</code> 卸载，再装 <code>2.x</code>（<code>pip install wsgidav</code> 会默认安装 <code>2.x</code> 我安装的是 <code>2.4.1</code></p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pip uninstall wsgidav  </span><br><span class="line">pip install wsgidav</span><br></pre></td></tr></tbody></table></figure>
<p>如果安装的 <code>wsgidav</code> 本还是 <code>3.x</code>, 可以在卸载这个版本之后，在安装命令后面加上具体版本号</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m pip install wsgidav==2.4.1</span><br></pre></td></tr></tbody></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.jakehu.me/2019/kubeadm-cluster/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://img.jakehu.me/avatar.png">
      <meta itemprop="name" content="jakehu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="晨曦's Blog">
      <meta itemprop="description" content="提笔为青春，人生正当时">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 晨曦's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/kubeadm-cluster/" class="post-title-link" itemprop="url">利用 Kubeadm 创建 Kubernetes 集群之 Centos，你会了吗？</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-01-21 16:38:00" itemprop="dateCreated datePublished" datetime="2019-01-21T16:38:00+08:00">2019-01-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-08-01 17:23:09" itemprop="dateModified" datetime="2024-08-01T17:23:09+08:00">2024-08-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%8A%80%E6%9C%AF%E6%B8%A3/" itemprop="url" rel="index"><span itemprop="name">技术渣</span></a>
        </span>
    </span>

  
    <span id="/2019/kubeadm-cluster/" class="post-meta-item leancloud_visitors" data-flag-title="利用 Kubeadm 创建 Kubernetes 集群之 Centos，你会了吗？" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>776</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>3 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="前记"><a href="#前记" class="headerlink" title="前记"></a>前记</h3><p><code>Kubeadm</code> 是一个工具，通过提供 <code>kubeadm init</code> 和 <code>kubeadm join</code> 来作为创建 <code>Kubernetes</code> 集群的最佳实践 “快速路径”</p>
<p>简单理解就跟 <code>Docker swarm</code> 差不多吧，<code>Kubeadm</code> 的 <code>GA</code> 版本都已经发布了，那还等什么呢？</p>
<h3 id="部署"><a href="#部署" class="headerlink" title="部署"></a>部署</h3><h5 id="资源版本"><a href="#资源版本" class="headerlink" title="资源版本"></a>资源版本</h5><ol>
<li><code>CentOS 7.6 64</code></li>
<li><code>Kubernetes version: v1.13.2</code></li>
<li><code>Docker version 18.06</code></li>
</ol>
<blockquote>
<p>这里为什么使用 <code>Docker 18.06</code> 是因为 <code>kubeadm now properly recognizes Docker 18.09.0 and newer, but still treats 18.06 as the default supported version.</code></p>
</blockquote>
<p>所以我们默认还是使用 <code>18.06</code></p>
<h5 id="服务器"><a href="#服务器" class="headerlink" title="服务器"></a>服务器</h5><p>这里我们使用 <code>CentOS 7.6 64</code>，同时测试环境为阿里云服务器</p>
<table>
<thead>
<tr>
<th>IP Address</th>
<th>Hostname</th>
<th>CPU</th>
<th>Memory</th>
</tr>
</thead>
<tbody><tr>
<td>172.16.1.86</td>
<td>Master</td>
<td>2C</td>
<td>4G</td>
</tr>
<tr>
<td>172.16.1.87</td>
<td>Node1</td>
<td>2C</td>
<td>4G</td>
</tr>
<tr>
<td>172.16.1.88</td>
<td>Node2</td>
<td>2C</td>
<td>4G</td>
</tr>
</tbody></table>
<blockquote>
<p>这里注意一下服务器系统，目前官方已支持 <code>Ubuntu 16.04+</code>、<code>Debian 9</code>、<code>CentOS 7</code>、<code>RHEL 7</code> 等</p>
</blockquote>
<h5 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h5><p>关闭防火墙</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">setenforce 0</span><br><span class="line">sed -i 's/^SELINUX=enforcing$/SELINUX=permissive/' /etc/selinux/config</span><br><span class="line">systemctl stop firewalld &amp;&amp; systemctl disable firewalld</span><br></pre></td></tr></tbody></table></figure>
<p>设定 <code>/etc/hosts</code></p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">172.16.1.86 Master</span><br><span class="line">172.16.1.87 Node1</span><br><span class="line">172.16.1.88 Node2</span><br></pre></td></tr></tbody></table></figure>
<p>禁用 <code>Swap</code></p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">swapoff -a &amp;&amp; sysctl -w vm.swappiness=0</span><br></pre></td></tr></tbody></table></figure>
<p>将配置中 <code>net.bridge.bridge-nf-call-iptables</code> 被设为 1</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cat &lt;&lt;EOF &gt;  /etc/sysctl.d/k8s.conf</span><br><span class="line">net.bridge.bridge-nf-call-ip6tables = 1</span><br><span class="line">net.bridge.bridge-nf-call-iptables = 1</span><br><span class="line">EOF</span><br></pre></td></tr></tbody></table></figure>
<h5 id="安装Docker"><a href="#安装Docker" class="headerlink" title="安装Docker"></a>安装 Docker</h5><p>在 3 台服务器上都安装上 <code>Docker</code>，此次实验 <code>Docker</code> 版本：<code>Docker version 18.06</code></p>
<p><a target="_blank" rel="noopener" href="https://docs.docker.com/install/linux/docker-ce/centos/">Centos Docker 安装文档</a></p>
<p>安装完成启动 <code>Docker</code></p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl enable docker.service</span><br></pre></td></tr></tbody></table></figure>
<h5 id="安装K8s"><a href="#安装K8s" class="headerlink" title="安装K8s"></a>安装 K8s</h5><p>在 3 台服务器上配置 <code>YUM</code> 源为阿里镜像源</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cat &lt;&lt;EOF &gt; /etc/yum.repos.d/kubernetes.repo</span><br><span class="line">[kubernetes]</span><br><span class="line">name=Kubernetes</span><br><span class="line">baseurl=http://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=0</span><br><span class="line">repo_gpgcheck=0</span><br><span class="line">gpgkey=http://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg http://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg</span><br><span class="line">EOF</span><br></pre></td></tr></tbody></table></figure>
<p>您需要在每台机器上都安装以下的软件包：</p>
<ol>
<li>kubeadm: 用来初始化集群的指令。</li>
<li>kubelet: 在集群中的每个节点上用来启动 <code>pod</code> 和 <code>container</code> 等。</li>
<li>kubectl: 用来与集群通信的命令行工具。</li>
</ol>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install -y kubelet kubeadm kubectl --disableexcludes=kubernetes</span><br><span class="line">systemctl enable kubelet &amp;&amp; systemctl start kubelet</span><br></pre></td></tr></tbody></table></figure>
<p>版本：<code>Kubernetes version: v1.13.2</code></p>
<h5 id="Master"><a href="#Master" class="headerlink" title="Master"></a>Master</h5><p>在 <code>Master</code> 节点上配置 <code>kubelet</code> 所需的 <code>cgroup</code> 驱动</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat &lt;&lt;EOF &gt;  /var/lib/kubelet/kubeadm-flags.env</span><br><span class="line">KUBELET_EXTRA_ARGS=--cgroup-driver=cgroupfs</span><br><span class="line">EOF</span><br></pre></td></tr></tbody></table></figure>
<p>需要重启 <code>kubelet</code>：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">systemctl daemon-reload</span><br><span class="line">systemctl restart kubelet</span><br></pre></td></tr></tbody></table></figure>
<p><code>k8s.gcr.io</code> 镜像本地化</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">kubeadm config images list //查看所需要的镜像</span><br><span class="line"></span><br><span class="line">// 编辑脚本从hub获取镜像</span><br><span class="line">vim k8s.sh</span><br><span class="line"></span><br><span class="line">#!/bin/bash</span><br><span class="line">docker pull coredns/coredns:1.2.6</span><br><span class="line">docker tag coredns/coredns:1.2.6 k8s.gcr.io/coredns:1.2.6</span><br><span class="line">docker rmi coredns/coredns:1.2.6</span><br><span class="line">images=(</span><br><span class="line">    kube-apiserver:v1.13.2</span><br><span class="line">    kube-controller-manager:v1.13.2</span><br><span class="line">    kube-scheduler:v1.13.2</span><br><span class="line">    kube-proxy:v1.13.2</span><br><span class="line">    pause:3.1</span><br><span class="line">    etcd:3.2.24</span><br><span class="line">)</span><br><span class="line">for imageName in ${images[@]} ; do</span><br><span class="line">  docker pull mirrorgooglecontainers/$imageName</span><br><span class="line">  docker tag mirrorgooglecontainers/$imageName k8s.gcr.io/$imageName</span><br><span class="line">  docker rmi mirrorgooglecontainers/$imageName</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">// 编辑脚本权限</span><br><span class="line">chmod +x k8s.sh</span><br><span class="line"></span><br><span class="line">// 执行脚本</span><br><span class="line">./k8s.sh</span><br></pre></td></tr></tbody></table></figure>

<p>初始化 <code>Master</code></p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubeadm init --kubernetes-version=v1.13.2 --pod-network-cidr=10.244.0.0/16</span><br></pre></td></tr></tbody></table></figure>
<p>配置 <code>kubectl</code> 认证信息</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 非root用户</span><br><span class="line">mkdir -p $HOME/.kube</span><br><span class="line">sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config</span><br><span class="line">sudo chown $(id -u):$(id -g) $HOME/.kube/config</span><br><span class="line"></span><br><span class="line"># root用户</span><br><span class="line">export KUBECONFIG=/etc/kubernetes/admin.conf</span><br><span class="line">echo "export KUBECONFIG=/etc/kubernetes/admin.conf" &gt;&gt; ~/.bash_profile</span><br></pre></td></tr></tbody></table></figure>
<p>安装网络插件 <code>flannel</code></p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/master/Documentation/kube-flannel.yml</span><br></pre></td></tr></tbody></table></figure>
<h5 id="Node"><a href="#Node" class="headerlink" title="Node"></a>Node</h5><p><code>Node</code> 镜像本地化</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">// 编辑脚本从hub获取镜像</span><br><span class="line">vim k8s.sh</span><br><span class="line"></span><br><span class="line">#!/bin/bash</span><br><span class="line">images=(</span><br><span class="line">    kube-proxy:v1.13.2</span><br><span class="line">    pause:3.1</span><br><span class="line">)</span><br><span class="line">for imageName in ${images[@]} ; do</span><br><span class="line">  docker pull mirrorgooglecontainers/$imageName</span><br><span class="line">  docker tag mirrorgooglecontainers/$imageName k8s.gcr.io/$imageName</span><br><span class="line">  docker rmi mirrorgooglecontainers/$imageName</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">// 编辑脚本权限</span><br><span class="line">chmod +x k8s.sh</span><br><span class="line"></span><br><span class="line">// 执行脚本</span><br><span class="line">./k8s.sh</span><br></pre></td></tr></tbody></table></figure>
<p>将节点加入集群</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubeadm join 172.16.1.86:6443 --token xxx --discovery-token-ca-cert-hash xxx</span><br></pre></td></tr></tbody></table></figure>

<h5 id="Dashboard"><a href="#Dashboard" class="headerlink" title="Dashboard"></a>Dashboard</h5><p>未完待续…</p>
<hr>
<p>题外话：</p>
<blockquote>
<p>安装过程中可以用 <code>tail -f 100 /var/log/messages</code> 查看日志，便于找到问题所在</p>
</blockquote>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.jakehu.me/2019/python-pip/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://img.jakehu.me/avatar.png">
      <meta itemprop="name" content="jakehu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="晨曦's Blog">
      <meta itemprop="description" content="提笔为青春，人生正当时">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 晨曦's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/python-pip/" class="post-title-link" itemprop="url">pip 之 No module named 'pip._internal'</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-01-15 17:20:00" itemprop="dateCreated datePublished" datetime="2019-01-15T17:20:00+08:00">2019-01-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-08-01 17:23:09" itemprop="dateModified" datetime="2024-08-01T17:23:09+08:00">2024-08-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%8A%80%E6%9C%AF%E6%B8%A3/" itemprop="url" rel="index"><span itemprop="name">技术渣</span></a>
        </span>
    </span>

  
    <span id="/2019/python-pip/" class="post-meta-item leancloud_visitors" data-flag-title="pip 之 No module named 'pip._internal'" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>142</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="前记"><a href="#前记" class="headerlink" title="前记"></a>前记</h3><p>说说本地环境 <code>Deepin 15.8</code>，<code>Python2</code> 与 <code>Python3</code> 共存</p>
<h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><p>问题如下：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ pip3</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File "/usr/local/bin/pip3", line 7, in &lt;module&gt;</span><br><span class="line">    from pip._internal import main</span><br><span class="line">ModuleNotFoundError: No module named 'pip._internal'</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ pip</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File "/usr/local/bin/pip", line 7, in &lt;module&gt;</span><br><span class="line">    from pip._internal import main</span><br><span class="line">ModuleNotFoundError: No module named 'pip._internal'</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p>如 <code>pip</code> 与 <code>pip3</code> 均不可使用</p>
<h3 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h3><figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ sudo easy_install pip</span><br><span class="line">Searching for pip</span><br><span class="line">Best match: pip 10.0.1</span><br><span class="line">Adding pip 10.0.1 to easy-install.pth file</span><br><span class="line">Installing pip script to /usr/local/bin</span><br><span class="line">Installing pip3.6 script to /usr/local/bin</span><br><span class="line">Installing pip3 script to /usr/local/bin</span><br><span class="line"></span><br><span class="line">Using /usr/local/lib/python2.7/dist-packages</span><br><span class="line">Processing dependencies for pip</span><br><span class="line">Finished processing dependencies for pip</span><br></pre></td></tr></tbody></table></figure>
<p>完美解决</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.jakehu.me/2019/java-k8s/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://img.jakehu.me/avatar.png">
      <meta itemprop="name" content="jakehu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="晨曦's Blog">
      <meta itemprop="description" content="提笔为青春，人生正当时">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 晨曦's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/java-k8s/" class="post-title-link" itemprop="url">通过 Gitlab 打包 Java-Spring Cloud 部署 K8s 部分备忘</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-01-05 09:20:00" itemprop="dateCreated datePublished" datetime="2019-01-05T09:20:00+08:00">2019-01-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-08-01 17:23:09" itemprop="dateModified" datetime="2024-08-01T17:23:09+08:00">2024-08-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%8A%80%E6%9C%AF%E6%B8%A3/" itemprop="url" rel="index"><span itemprop="name">技术渣</span></a>
        </span>
    </span>

  
    <span id="/2019/java-k8s/" class="post-meta-item leancloud_visitors" data-flag-title="通过 Gitlab 打包 Java-Spring Cloud 部署 K8s 部分备忘" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>216</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="公共包的处理"><a href="#公共包的处理" class="headerlink" title="公共包的处理"></a>公共包的处理</h3><p>解决方案是将公共包打包在 <code>runner</code> 服务器上，其他模块打包时自动应用公共包<code>.gitlab-ci.yml</code> 如下：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">stages:</span><br><span class="line">  - deploy</span><br><span class="line">maven-build:</span><br><span class="line">  stage: deploy</span><br><span class="line">  script: </span><br><span class="line">    - mvn install</span><br></pre></td></tr></tbody></table></figure>
<h3 id="注册中心地址"><a href="#注册中心地址" class="headerlink" title="注册中心地址"></a>注册中心地址</h3><p><code>Eureka</code> 地址应为 <code>http://[service name]:[port]/eureka</code></p>
<p>切记 <code>http</code> 协议</p>
<h3 id="runner提权"><a href="#runner提权" class="headerlink" title="runner提权"></a>runner 提权</h3><p>在 <code>gitlab-runner</code> 装好后并不能通过 <code>CI</code> 执行，因为 <code>gitlab-runner</code> 是通过 <code>gitlab-runner</code> 用户及用户组运行的，并不是 <code>ROOT</code> 权限，所以这里就需要对 <code>gitlab-runner</code> 用户进行提权</p>
<p>说到提权这里说两种方式</p>
<blockquote>
<ol>
<li><code>usermod</code></li>
</ol>
</blockquote>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">usermod -ag root gitlab-runner // 将gitlab-runner用户加入root用户组</span><br><span class="line"></span><br><span class="line">// 不过这种方式我没有成功，我使用的是第二种方式</span><br></pre></td></tr></tbody></table></figure>
<blockquote>
<ol start="2">
<li><code>/etc/passwd</code></li>
</ol>
</blockquote>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">vi /etc/passwd</span><br><span class="line">gitlab-runner:x:997:993:GitLab Runner:/home/gitlab-runner:/bin/bash // 修改前</span><br><span class="line">gitlab-runner:x:0:0:GitLab Runner:/home/gitlab-runner:/bin/bash // 修改后</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>

<hr>
<p>未完待续</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.jakehu.me/2019/mac-software/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://img.jakehu.me/avatar.png">
      <meta itemprop="name" content="jakehu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="晨曦's Blog">
      <meta itemprop="description" content="提笔为青春，人生正当时">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 晨曦's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2019/mac-software/" class="post-title-link" itemprop="url">Mac 常用软件备份</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2019-01-05 09:09:00" itemprop="dateCreated datePublished" datetime="2019-01-05T09:09:00+08:00">2019-01-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-08-01 17:23:09" itemprop="dateModified" datetime="2024-08-01T17:23:09+08:00">2024-08-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E8%B5%84%E6%BA%90%E6%8E%A7/" itemprop="url" rel="index"><span itemprop="name">资源控</span></a>
        </span>
    </span>

  
    <span id="/2019/mac-software/" class="post-meta-item leancloud_visitors" data-flag-title="Mac 常用软件备份" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>135</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h4 id="microsoft-remote-desktop-for-mac"><a href="#microsoft-remote-desktop-for-mac" class="headerlink" title="microsoft remote desktop for mac"></a>microsoft remote desktop for mac</h4><p>根据<a target="_blank" rel="noopener" href="https://learn.microsoft.com/zh-cn/azure/virtual-desktop/users/client-features-macos">【官方文档】</a>所示，两种方式获取</p>
<ol>
<li>Mac 应用应用商店下载 (只支持美区)</li>
<li>Mac beta 版，通过<a target="_blank" rel="noopener" href="https://install.appcenter.ms/orgs/rdmacios-k2vy/apps/microsoft-remote-desktop-for-mac/distribution_groups/all-users-of-microsoft-remote-desktop-for-mac">【appcenter】</a>下载</li>
<li>商店之外正版<a target="_blank" rel="noopener" href="https://go.microsoft.com/fwlink/?linkid=868963">下载</a>，参考：<a target="_blank" rel="noopener" href="https://community.spiceworks.com/topic/2123651-microsoft-remote-desktop-now-available-outside-the-app-store">Microsoft Remote Desktop now available outside the App Store</a></li>
</ol>
<h4 id="Mos"><a href="#Mos" class="headerlink" title="Mos"></a>Mos</h4><p>一个用于在 macOS 上平滑你的鼠标滚动效果或单独设置滚动方向的小工具，让你的滚轮爽如触控板</p>
<p><a target="_blank" rel="noopener" href="https://github.com/Caldis/Mos">Mos</a></p>
<h4 id="Redis客户端"><a href="#Redis客户端" class="headerlink" title="Redis客户端"></a>Redis 客户端</h4><p><code>Redis</code> 客户端众多，安利两款自己用过，还觉得不错的</p>
<p><a target="_blank" rel="noopener" href="https://github.com/qishibo/AnotherRedisDesktopManager">AnotherRedisDesktopManager</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/luin/medis">Medis</a></p>
<hr>
<p>未完待续</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.jakehu.me/2018/LCN-GTS/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://img.jakehu.me/avatar.png">
      <meta itemprop="name" content="jakehu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="晨曦's Blog">
      <meta itemprop="description" content="提笔为青春，人生正当时">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 晨曦's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/LCN-GTS/" class="post-title-link" itemprop="url">分布式事务 LCN 和 GTS 比较 and 你更喜欢谁？</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-12-22 16:30:00" itemprop="dateCreated datePublished" datetime="2018-12-22T16:30:00+08:00">2018-12-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-11-26 15:59:12" itemprop="dateModified" datetime="2024-11-26T15:59:12+08:00">2024-11-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%8A%80%E6%9C%AF%E6%B8%A3/" itemprop="url" rel="index"><span itemprop="name">技术渣</span></a>
        </span>
    </span>

  
    <span id="/2018/LCN-GTS/" class="post-meta-item leancloud_visitors" data-flag-title="分布式事务 LCN 和 GTS 比较 and 你更喜欢谁？" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>896</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>3 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="LCN简介"><a href="#LCN简介" class="headerlink" title="LCN简介"></a>LCN 简介</h3><ol>
<li>LCN 分布式事务框架的核心功能是对本地事务的协调控制，框架本身并不创建事务，只是对本地事务做协调控制</li>
<li>因此该框架与其他第三方的框架兼容性强，支持所有的关系型数据库事务，支持多数据源，支持与第三方数据库框架一块使用</li>
<li>在使用框架的时候只需要添加分布式事务的注解即可，对业务的侵入性低</li>
</ol>
<h3 id="LCN核心步骤"><a href="#LCN核心步骤" class="headerlink" title="LCN核心步骤"></a>LCN 核心步骤</h3><ol>
<li>创建事务组，是指在事务发起方开始执行业务代码之前先调用 TxManager 创建事务组对象，然后拿到事务标示 GroupId 的过程</li>
<li>添加事务组，添加事务组是指参与方在执行完业务方法以后，将该模块的事务信息添加通知给 TxManager 的操作</li>
<li>关闭事务组，是指在发起方执行完业务代码以后，将发起方执行结果状态通知给 TxManager 的动作。当执行完关闭事务组的方法以后，TxManager 将根据事务组信息来通知相应的参与模块提交或回滚事务</li>
</ol>
<h3 id="LCN事务控制原理"><a href="#LCN事务控制原理" class="headerlink" title="LCN事务控制原理"></a>LCN 事务控制原理</h3><p>LCN 事务控制原理是由事务模块 TxClient 下的代理连接池与 TxManager 的协调配合完成的事务协调控制 TxClient 的代理连接池实现了 javax.sql.DataSource 接口，并重写了 close 方法，事务模块在提交关闭以后 TxClient 连接池将执行” 假关闭” 操作，等待 TxManager 协调完成事务以后在关闭连接<br><img src="https://img.jakehu.me/1.png"></p>
<h3 id="阿里云GTS全局事务服务"><a href="#阿里云GTS全局事务服务" class="headerlink" title="阿里云GTS全局事务服务"></a>阿里云 GTS 全局事务服务</h3><ol>
<li>全局事务服务（Global Transaction Service，简称 GTS）是一款高性能、高可靠、接入简单的分布式事务中间件，用于解决分布式环境下的事务一致性问题</li>
<li> GTS 支持 DRDS、RDS、MySQL 等多种数据源，可以配合 EDAS 和 SpringCloud 等微服务框架使用， 兼容 MQ 实现事务消息。通过各种组合，可以轻松实现分布式数据库事务、多库事务、消息事务、服务链路级事务等多种业务需求</li>
</ol>
<h3 id="GTS模拟场景演示"><a href="#GTS模拟场景演示" class="headerlink" title="GTS模拟场景演示"></a>GTS 模拟场景演示</h3><p><img src="https://img.jakehu.me/2.png"></p>
<h3 id="性能"><a href="#性能" class="headerlink" title="性能"></a>性能</h3><p>GTS 通过大量创新，解决了事务 ACID 特性与高性能、高可用、低侵入不可兼得的问题。单事务分支的平均响应时间在 2ms 左右，3 台服务器组成的集群可以支撑 3 万 TPS 以上的分布式事务请求</p>
<p>LCN 性能参考：<a target="_blank" rel="noopener" href="http://springcloud.cn/view/374">http://springcloud.cn/view/374</a>在众多开源分布式事务框架中，LCN 性能是处于前列的</p>
<h3 id="LCN总结"><a href="#LCN总结" class="headerlink" title="LCN总结"></a>LCN 总结</h3><p>优点:</p>
<ul>
<li>性能优秀</li>
<li>可靠性强</li>
<li> LCN 实现的分布式事务处理模式，编码复杂性和入侵代码量低</li>
</ul>
<p>缺点:</p>
<ul>
<li>需额外部署 tx-manager 服务节点</li>
<li>由于需要 lock 资源这种处理方式，如果集中更新某几个热门商品时，LCN 的性能衰减量大于 TCC 模式</li>
<li>服务超时时，会造成其他服务的资源被锁住，比如支付服务超时过程中，相关商品库存会一直无法操作</li>
<li>不支持 SpringCloud 2.0.0 及以上版本（目前已通过修改源码实现支持）</li>
</ul>
<h3 id="GTS总结"><a href="#GTS总结" class="headerlink" title="GTS总结"></a>GTS 总结</h3><p>优点:</p>
<ul>
<li>性能优秀 (有淘宝双十一作为示例）</li>
<li>可靠性强</li>
<li>代码入侵性小（相比 LCN 多一点）</li>
<li>支持 SpringCloud 2.0.0 及以上版本</li>
</ul>
<p>缺点:</p>
<ul>
<li>无法在本地进行测试</li>
<li>只能在阿里云内网使用，或者购买专有云</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.jakehu.me/2018/hexo-pages/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://img.jakehu.me/avatar.png">
      <meta itemprop="name" content="jakehu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="晨曦's Blog">
      <meta itemprop="description" content="提笔为青春，人生正当时">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 晨曦's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/hexo-pages/" class="post-title-link" itemprop="url">Hexo 在 Github 慢？不存在百度云？七牛？又拍？</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-12-22 10:26:00" itemprop="dateCreated datePublished" datetime="2018-12-22T10:26:00+08:00">2018-12-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-08-01 17:23:09" itemprop="dateModified" datetime="2024-08-01T17:23:09+08:00">2024-08-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%8A%80%E6%9C%AF%E6%B8%A3/" itemprop="url" rel="index"><span itemprop="name">技术渣</span></a>
        </span>
    </span>

  
    <span id="/2018/hexo-pages/" class="post-meta-item leancloud_visitors" data-flag-title="Hexo 在 Github 慢？不存在百度云？七牛？又拍？" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>242</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="前记"><a href="#前记" class="headerlink" title="前记"></a>前记</h3><p>博客 <code>hexo</code> 一直部署在 <code>Github Pages</code>，方便、稳定非常 <code>nice</code>，但是最近发现打开博客的速度比较慢。于是想着能否通过多部署，或者国内 <code>CDN</code> 加快访问速度</p>
<h3 id="加速方案"><a href="#加速方案" class="headerlink" title="加速方案"></a>加速方案</h3><ol>
<li>利用 <code>Gitee Pages</code> 作为国内部署，但是 <code>Gitee Pages</code> 免费版不支持 <code>https</code>，遂作罢</li>
<li>利用 <code>Coding Pages</code> 作为国内部署，支持 <code>Let's Encrypt https</code>，但发现所加速的 <code>IP</code> 均为国外 <code>IP</code>，有时也比较的慢，于是尝试在国内找 <code>cdn</code> 加速就有了下面方案的对比</li>
<li>百度云：免费版不支持 <code>https</code>，遂作罢</li>
<li>腾讯云：没有免费额度，支持上传自有证书，遂作罢</li>
<li>七牛 CDN：免费 10G 额度，免费版不支持 <code>https</code>，遂作罢</li>
<li>又拍云 (在用方案，目前最完美方案)：支持 <code>Let's Encrypt</code> 加入<a target="_blank" rel="noopener" href="https://www.upyun.com/league">又拍云联盟</a> 10G 空间 + 15G 流量额度</li>
</ol>
<h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h3><p>加速过后速度杠杠的</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://www.jakehu.me/2018/etc-fstab/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://img.jakehu.me/avatar.png">
      <meta itemprop="name" content="jakehu">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="晨曦's Blog">
      <meta itemprop="description" content="提笔为青春，人生正当时">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | 晨曦's Blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2018/etc-fstab/" class="post-title-link" itemprop="url">修改 /etc/fstab 后可以不重启吗？答案是肯定的</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2018-12-20 09:31:00" itemprop="dateCreated datePublished" datetime="2018-12-20T09:31:00+08:00">2018-12-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">更新于</span>
      <time title="修改时间：2024-08-01 17:23:09" itemprop="dateModified" datetime="2024-08-01T17:23:09+08:00">2024-08-01</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E6%8A%80%E6%9C%AF%E6%B8%A3/" itemprop="url" rel="index"><span itemprop="name">技术渣</span></a>
        </span>
    </span>

  
    <span id="/2018/etc-fstab/" class="post-meta-item leancloud_visitors" data-flag-title="修改 /etc/fstab 后可以不重启吗？答案是肯定的" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>216</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h3 id="前记"><a href="#前记" class="headerlink" title="前记"></a>前记</h3><p>最近由于项目比较大而且附件比较多，在服务器上选择了外挂 <code>Nas</code> 盘符来存储项目文件</p>
<p>目前服务器和 <code>Nas</code> 都是用的阿里的服务，这里说一下阿里在 <code>Linux</code> 中自动挂载的注意事项，在 <code>/etc/fstab</code> 配置文件中添加以下命令：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fid-xxxx.cn-hangzhou.nas.aliyuncs.com:/ /mnt  nfs4 vers=4.0,rsize=1048576,wsize=1048576,hard,timeo=600,retrans=2,_netdev,noresvport 0 0</span><br></pre></td></tr></tbody></table></figure>
<p>重点来了，请注意：</p>
<blockquote>
<p>命令中的 <code>fid-xxxx.cn-hangzhou.nas.aliyuncs.com</code> 为挂载点的域名</p>
</blockquote>
<p>我第一次的时候就把 <code>xxxx.cn-hangzhou.nas.aliyuncs.com</code> 替换为了挂载点的域名，而保留了 <code>fid</code></p>
<h3 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h3><p>按阿里官方说明为重启时自动挂载 <code>NAS</code> 文件系统，如果需要及时生效可以运行以下命令而不用重启：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo mount -a</span><br><span class="line">-a：将 /etc/fstab 中定义的所有档案系统挂上</span><br></pre></td></tr></tbody></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <a class="extend prev" rel="prev" title="上一页" aria-label="上一页" href="/page/10/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><span class="page-number current">11</span><a class="page-number" href="/page/12/">12</a><span class="space">&hellip;</span><a class="page-number" href="/page/15/">15</a><a class="extend next" rel="next" title="下一页" aria-label="下一页" href="/page/12/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">渝ICP备2024046745号-1 </a>
  </div>
  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2024</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">jakehu</span>
  </div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>站点总字数：</span>
    <span title="站点总字数">36k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>站点阅读时长 &asymp;</span>
    <span title="站点阅读时长">2:12</span>
  </span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="reading-progress-bar"></div>

  <a href="https://github.com/jakehu" class="github-corner" title="在 GitHub 上关注我" aria-label="在 GitHub 上关注我" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pangu/4.0.7/pangu.min.js" integrity="sha256-j+yj56cdEY2CwkVtGyz18fNybFGpMGJ8JxG3GSyO2+I=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>







  


  <script class="next-config" data-name="leancloud_visitors" type="application/json">{"enable":true,"app_id":"uLM2WFMDtpXvCYe9LInEc284","app_key":"efF52z8z4mcr5W5ELtJvIbQ2","server_url":null,"security":false}</script>
  <script src="/js/third-party/statistics/lean-analytics.js"></script>


<script class="next-config" data-name="utterances" type="application/json">{"enable":true,"repo":"jakehu/jakehu.github.io","issue_term":"pathname","theme":"github-light"}</script>
<script src="/js/third-party/comments/utterances.js"></script>

</body>
</html>
